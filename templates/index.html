<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Finance Hub</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; display: flex; justify-content: center; padding: 20px; }
        .container { width: 100%; max-width: 500px; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        
        /* Goal Bar */
        .progress-container { background: #eee; border-radius: 10px; height: 25px; margin: 15px 0; overflow: hidden; }
        .progress-bar { height: 100%; background: #007bff; transition: width 0.5s; width: var(--pg-width); display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; font-weight: bold; }

        .section-title { margin-top: 0; color: #333; border-bottom: 2px solid #eee; padding-bottom: 5px; }
        input { width: 95%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px; }
        button { width: 100%; padding: 10px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; color: white; margin-top: 5px; }
        
        /* List Styling */
        .history-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f9f9f9; font-size: 0.9rem; }
        .tag { padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; text-transform: uppercase; font-weight: bold; margin-right: 5px; }
        .tag-apt { background: #e3f2fd; color: #007bff; }
        .tag-exp { background: #fff3e0; color: #ef6c00; }
    </style>
</head>
<body>

<div class="container">
    <div class="card">
        <h2 class="section-title">üè† {{ goal.name }} Goal</h2>
        <div class="progress-container">
            <div class="progress-bar" style="--pg-width: {{ percent }}%;">{{ percent|round|int }}%</div>
        </div>
        <p>Saved for Apartment: <strong>${{ "{:,.2f}".format(apartment_savings) }}</strong> / ${{ "{:,.2f}".format(goal.target) }}</p>
        
        <form action="/add_transaction" method="POST">
            <input type="number" step="0.01" name="amount" placeholder="Amount to add to {{ goal.name }}" required>
            <input type="text" name="source" placeholder="Source (e.g. Work Paycheck)" required>
            <input type="hidden" name="type" value="apartment">
            <button type="submit" style="background: #007bff;">Deposit to Apartment Fund</button>
        </form>
    </div>

    <div class="card">
        <h2 class="section-title">üí∏ Daily Expenses</h2>
        <p>Total Spent (Apartment not affected): <strong style="color: #ef6c00;">${{ "{:,.2f}".format(total_expenses) }}</strong></p>
        
        <form action="/add_transaction" method="POST">
            <input type="number" step="0.01" name="amount" placeholder="Amount spent" required>
            <input type="text" name="source" placeholder="Spent on? (e.g. Lunch, Gas)" required>
            <input type="hidden" name="type" value="expense">
            <button type="submit" style="background: #ef6c00;">Log Expense</button>
        </form>
    </div>

    <div class="card">
        <h3 class="section-title">History</h3>
        {% for item in history %}
        <div class="history-item">
            <div>
                <span class="tag {{ 'tag-apt' if item.ttype == 'apartment' else 'tag-exp' }}">
                    {{ 'Goal' if item.ttype == 'apartment' else 'Spend' }}
                </span>
                <strong>{{ item.source }}</strong>
            </div>
            <div>
                <span>${{ "{:,.2f}".format(item.amount) }}</span>
                <a href="/delete/{{ item.id }}" style="color:#ccc; text-decoration:none; margin-left:10px;">√ó</a>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

</body>
</html>